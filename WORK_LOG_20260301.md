# ì‘ì—… ì¼ì§€ â€” 2026-03-01

## ìˆ˜ìˆ˜ë£Œ Firestore ì—°ë™ + ì°¸ê³ ìš© ë§¤í•‘ ì„œë¸Œíƒ­ ì¶”ê°€

### 1. ì ‘ìˆ˜ ë“±ë¡ â€” Firestore ìˆ˜ìˆ˜ë£Œ ì—°ë™ (sampleReceipt.html)

**ë¬¸ì œ:** ì ‘ìˆ˜ ë“±ë¡ í˜ì´ì§€ì˜ ìˆ˜ìˆ˜ë£Œê°€ `js/mfds-fee-mapping.js` í•˜ë“œì½”ë”© ê°’(`MFDS_FEE_MAP`)ì—ì„œë§Œ ê°€ì ¸ì˜´. ê²€ì‚¬ëª©ì  ê´€ë¦¬ì—ì„œ ìˆ˜ìˆ˜ë£Œë¥¼ ìˆ˜ì •Â·ì €ì¥í•´ë„ ì ‘ìˆ˜ ë“±ë¡ì— ë°˜ì˜ ì•ˆ ë¨.

**í•´ê²°:**
- `loadFirestoreFeeMap()`: firebase-ready ì´ë²¤íŠ¸ì—ì„œ Firestore `settings/mfdsFeeMapping` ë¡œë“œ â†’ `_firestoreFeeMap` ìºì‹±
- `getFeeByCode(testCode)`: Firestore ìš°ì„  â†’ `MFDS_FEE_MAP` JS í´ë°± ìˆœì„œë¡œ ì¡°íšŒ
- ê¸°ì¡´ `MFDS_FEE_MAP` ì§ì ‘ ì°¸ì¡° â†’ `getFeeByCode()` í˜¸ì¶œë¡œ êµì²´
- `loadMfdsStandardItems()` ë‚´ ê¸°ì¤€ê·œê²© í…Œì´ë¸” data-fee ì„¤ì • ë¶€ë¶„ ìˆ˜ì •

### 2. ì°¸ê³ ìš© ìˆ˜ìˆ˜ë£Œ â€” Firestore ì—°ë™ (sampleReceipt.html)

**ë¬¸ì œ:** ì°¸ê³ ìš©(ê¸°ì¤€ê·œê²©ì™¸) ìˆ˜ìˆ˜ë£Œê°€ `mfdsTemplates`ì˜ testItems.feeì—ì„œ ì¶”ì¶œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ, ë³„ë„ ê´€ë¦¬ UI ì—†ìŒ.

**í•´ê²°:**
- `buildRefFeeMap()` ìˆ˜ì •: Firestore `settings/refFeeMapping` ìš°ì„  ë¡œë“œ â†’ mfdsTemplates í´ë°±
- ì°¸ê³ ìš© ë§¤í•‘ íƒ­ì—ì„œ ì €ì¥í•œ ìˆ˜ìˆ˜ë£Œê°€ ì ‘ìˆ˜ ë“±ë¡ì— ë°”ë¡œ ë°˜ì˜ë¨

### 3. ê²€ì‚¬ëª©ì  ê´€ë¦¬ â€” ì°¸ê³ ìš© ë§¤í•‘ ì„œë¸Œíƒ­ ì¶”ê°€ (inspectionMgmt.html)

**êµ¬í˜„ ë‚´ìš©:**
- ìˆ˜ìˆ˜ë£Œ íƒ­ì— 3ë²ˆì§¸ ì„œë¸Œíƒ­ **ğŸ“‹ ì°¸ê³ ìš© ë§¤í•‘** ì¶”ê°€
- `switchFeeSubtab()` ìˆ˜ì •: list, mfds, **ref** 3ê°œ íƒ­ ì§€ì›
- ë°ì´í„° ì†ŒìŠ¤: `mfds_test_items` Firestore ì»¬ë ‰ì…˜ (2,171ê±´, ë†ì•½ Eì½”ë“œ 769ê±´ ì œê±°)
- Firestore ì €ì¥: `settings/refFeeMapping`
- ê²€ìƒ‰, í•„í„°ë§(ìˆ˜ìˆ˜ë£Œ ì„¤ì •ëœ í•­ëª©ë§Œ), ìˆ˜ìˆ˜ë£Œ í¸ì§‘, ë¹„ê³  í¸ì§‘ ì§€ì›
- 4ê°œ í•¨ìˆ˜ ì¶”ê°€: `loadAndRenderRefFee()`, `renderRefFeeTable()`, `updateRefFee()`, `updateRefNote()`, `saveRefFeesToFirestore()`

### 4. ìˆ˜ìˆ˜ë£Œ ëª©ë¡ â†’ ì°¸ê³ ìš© ë§¤í•‘ ë°ì´í„° ì´ì „

**ì´ì „ ë°©ì‹:**
1. ìˆ˜ìˆ˜ë£Œ ëª©ë¡ > ì°¸ê³ ìš©(ê¸°ì¤€ê·œê²©ì™¸) 3,374ê±´ì—ì„œ ê³ ìœ  í•­ëª©ëª… 234ê°œ ì¶”ì¶œ
2. ê²€ì²´ìœ í˜•ì€ ë¬´ì‹œ, í•­ëª©ëª… ê¸°ì¤€ ìµœëŒ€ ìˆ˜ìˆ˜ë£Œ ì‚¬ìš©
3. **ì •í™• ë§¤ì¹­** (í•­ëª©ëª… ì¼ì¹˜): 96ê±´
4. **ê´„í˜¸ ì œê±° ë§¤ì¹­** (ì˜ˆ: "ëŒ€ì¥ê· (ì •ëŸ‰)" â†’ "ëŒ€ì¥ê· "): 43ê±´ â€” ê´„í˜¸ ë‚´ìš©ì€ ë¹„ê³ ì— ì €ì¥
5. ìµœì¢… **102ê±´** ìˆ˜ìˆ˜ë£Œ ì„¤ì •, **16ê±´** ë¹„ê³  ì €ì¥
6. ë¯¸ë§¤ì¹­ 95ê±´: ì˜ë¬¸ í•­ëª©ëª…(ì§€ë°©ì‚°/ë†ì•½ ë“±)ìœ¼ë¡œ ì°¸ê³ ìš© ë§¤í•‘ì— í•´ë‹¹ ì‹œí—˜í•­ëª© ì—†ìŒ

**ì£¼ì˜ì‚¬í•­:**
- ì´ˆê¸° êµ¬ì„± ì‹œ ì‹ì•½ì²˜ ë§¤í•‘(mfdsFeeMapping) ìˆ˜ìˆ˜ë£Œë¥¼ ì°¸ê³ ìš©ì— í˜¼ì…í•˜ëŠ” ë²„ê·¸ ìˆ˜ì • ì™„ë£Œ
- `loadAndRenderRefFee()` ì´ˆê¸° êµ¬ì„±ì—ì„œ fee=0ìœ¼ë¡œ ì‹œì‘í•˜ë„ë¡ ë³€ê²½
- ì”ë¥˜ë†ì•½(Eì½”ë“œ) 769ê±´ì€ ì‚­ì œë¨

### 5. ë¹„ê³  ì»¬ëŸ¼ êµ¬í˜„

- ì°¸ê³ ìš© ë§¤í•‘ í…Œì´ë¸”ì— ë¹„ê³ (note) ì»¬ëŸ¼ ì¶”ê°€
- ê´„í˜¸ ì œê±° ë§¤ì¹­ ì‹œ ê´„í˜¸ ë‚´ìš© ìë™ ì €ì¥ (ì˜ˆ: "n=5,ì •ëŸ‰ / n=5,ì •ì„± / ì •ëŸ‰ / ì •ì„±")
- `updateRefNote()` í•¨ìˆ˜ë¡œ ë¹„ê³  ì§ì ‘ í¸ì§‘ ê°€ëŠ¥

---

## ìˆ˜ì •ëœ íŒŒì¼

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|-----------|
| `sampleReceipt.html` | `loadFirestoreFeeMap()`, `getFeeByCode()` ì¶”ê°€, `buildRefFeeMap()` Firestore ìš°ì„  ë¡œë“œ, MFDS_FEE_MAP ì§ì ‘ ì°¸ì¡° ì œê±° |
| `inspectionMgmt.html` | ì°¸ê³ ìš© ë§¤í•‘ ì„œë¸Œíƒ­ HTML + JS í•¨ìˆ˜ 5ê°œ, switchFeeSubtab() ref ì§€ì›, loadAndRenderRefFee() ì´ˆê¸° êµ¬ì„± ìˆ˜ì • |

## Firestore ë°ì´í„° ë³€ê²½

| ê²½ë¡œ | ë‚´ìš© |
|------|------|
| `settings/mfdsFeeMapping` | ê¸°ì¡´ (ìê°€í’ˆì§ˆìœ„íƒê²€ì‚¬ìš© 166ê±´) â€” ë³€ê²½ ì—†ìŒ |
| `settings/refFeeMapping` | **ì‹ ê·œ** â€” ì°¸ê³ ìš© ì‹œí—˜í•­ëª© 2,171ê±´ + ìˆ˜ìˆ˜ë£Œ 102ê±´ + ë¹„ê³  16ê±´ |

## ì»¤ë°‹ ì´ë ¥

1. `f08dfbe` â€” ìˆ˜ìˆ˜ë£Œ Firestore ì—°ë™ + ì°¸ê³ ìš© ë§¤í•‘ ì„œë¸Œíƒ­ ì¶”ê°€
2. `7a8ea56` â€” ì°¸ê³ ìš© ë§¤í•‘ ë¹„ê³  ì»¬ëŸ¼ ì¶”ê°€ + ìˆ˜ìˆ˜ë£Œ ëª©ë¡ì—ì„œ ê´„í˜¸ ì œê±° ë§¤ì¹­ ì´ì „
3. `7cc6669` â€” ì°¸ê³ ìš© ë§¤í•‘ ì´ˆê¸° êµ¬ì„± ì‹œ ì‹ì•½ì²˜ ë§¤í•‘ ìˆ˜ìˆ˜ë£Œ í˜¼ì… ë°©ì§€

## ë°ì´í„° íë¦„ (í˜„ì¬)

```
[ê²€ì‚¬ëª©ì  ê´€ë¦¬ > ìˆ˜ìˆ˜ë£Œ > ì‹ì•½ì²˜ ë§¤í•‘]
  ìˆ˜ìˆ˜ë£Œ í¸ì§‘ â†’ Firestore settings/mfdsFeeMapping ì €ì¥
                    â†“
[ì ‘ìˆ˜ ë“±ë¡ (ìê°€í’ˆì§ˆìœ„íƒê²€ì‚¬ìš©)]
  loadFirestoreFeeMap() â†’ settings/mfdsFeeMapping ë¡œë“œ (í´ë°±: MFDS_FEE_MAP JS)
  getFeeByCode(testCode) â†’ ìˆ˜ìˆ˜ë£Œ ì¡°íšŒ

[ê²€ì‚¬ëª©ì  ê´€ë¦¬ > ìˆ˜ìˆ˜ë£Œ > ì°¸ê³ ìš© ë§¤í•‘]
  ìˆ˜ìˆ˜ë£Œ í¸ì§‘ â†’ Firestore settings/refFeeMapping ì €ì¥
                    â†“
[ì ‘ìˆ˜ ë“±ë¡ (ì°¸ê³ ìš©)]
  buildRefFeeMap() â†’ settings/refFeeMapping ë¡œë“œ (í´ë°±: mfdsTemplates)
```

## ë°°í¬ ì •ë³´

- **SSH**: `ssh -p 2222 biofl@14.7.14.31` (ë¹„ë°€ë²ˆí˜¸: `bphsk*1411**`)
- **ë°°í¬ ë°©ë²•**: paramikoë¡œ ì ‘ì† í›„ `cd /home/biofl/bfl_lims && git pull origin main`
- **Preview ì„œë²„**: port 8897
